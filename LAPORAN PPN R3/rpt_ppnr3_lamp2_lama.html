<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <title>Laporan PPN Listrik Rumah Tangga</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, Helvetica, sans-serif;
        }

        @page {
            size: A4 landscape;
            margin: 1cm;
        }

        body {
            width: max-content;
            padding: 10px;
            margin: auto;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th {
            background-color: #c0c0c0;
        }


        table.header-table {
            font-size: 13px;
        }

        /* --- STYLE KHUSUS UNTUK DATA TABLE --- */
        table.table-data {
            font-size: 11px;
            border: 1px solid #000;
            margin-top: 10px;
            width: 100%;
            border-collapse: collapse;
        }

        table.table-data th,
        table.table-data td {
            border: 1px solid #000;
            padding: 6px 6px;
            text-align: center;
            vertical-align: middle;
        }

        table.table-data th {
            background-color: #e6e6e6;
            font-weight: 500;
        }

        .keterangan {
            margin-top: 20px;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 13px;
        }

        .tbl-keterangan {
            width: 50%;
            border-collapse: collapse;
        }

        .tbl-keterangan td {
            vertical-align: top;
            padding: 4px 10px;
        }

        .kolom-kiri {
            width: 60%;
        }

        .kolom-kanan {
            width: 40%;
        }

        .tbl-keterangan p {
            margin: 3px 0;
            line-height: 1.3;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <table class="header-table" style="width: 100%; border-collapse: collapse; margin-bottom: 8px;">
        <tr>
            <!-- Kiri -->
            <td style="width: 25%; text-align: left;">
                <table style="width: 100%; border-collapse: collapse;">
                    <tr>
                        <!-- Logo di kiri -->
                        <td style="width: 64px; vertical-align: top;">
                            <img src="data:image/png;base64,{logoBase64}" alt="Logo" width="64" />
                        </td>

                        <!-- Info di kanan -->
                        <td style="vertical-align: top; padding-left: 6px;">
                            <div style="margin-bottom: 8px">{namaupi}</div>
                            <div style="margin-bottom: 8px">{namaap}</div>
                            <div style="margin-bottom: 8px">{namaup}</div>
                        </td>
                    </tr>
                </table>
            </td>

            <!-- Tengah -->
            <td style="width: 50%; text-align: center; vertical-align: middle; padding: 6px;">
                <div class="header-center" style="font-weight: bold; line-height: 1.6;">
                    <div>Laporan PPN Listrik Rumah Tangga</div>
                    <div>Lampiran - 2</div>
                    <div>Bulan Tahun Laporan: {bulantahun}</div>
                </div>
            </td>

            <!-- Kanan -->
            <td style="width: 25%;"></td>
        </tr>
    </table>

    <!-- Data Table -->
    <table class="table-data">
        <thead>
            <tr>
                <th rowspan="4">ID PELANGGAN</th>
                <th rowspan="4">NAMA<br>PELANGGAN</th>
                <th rowspan="4">DAYA</th>
                <th rowspan="4">NPWP</th>
                <th rowspan="4">TARIF</th>
                <th colspan="2" rowspan="3">TOTAL PENETAPAN & PENERIMAAN DIMUKA</th>
                <th colspan="12">RESTITUSI</th>
                <th colspan="2" rowspan="3">TOTAL PPN R3</th>
            </tr>
            <tr>
                <th colspan="8">NON TAGLIS</th>
                <th colspan="2" rowspan="2">PRA BAYAR</th>
                <th colspan="2" rowspan="2">TOTAL RESTITUSI</th>
            </tr>
            <tr>
                <th colspan="2">TOKEN AWAL</th>
                <th colspan="2">PESTA</th>
                <th colspan="2">TS P2TL</th>
                <th colspan="2">TS KWH</th>
            </tr>
            <tr>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
                <th>RTL</th>
                <th>PPN R3</th>
            </tr>
            <tr>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
                <th>13</th>
                <th>14</th>
                <th>15</th>
                <th>16</th>
                <th>17</th>
                <th>18</th>
                <th>19</th>
                <th>20</th>
                <th>21</th>
            </tr>
        </thead>

        <tbody>
            {#for item in data}
            <tr>
                <td>{item.idpel}</td>
                <td>{item.namaplg}</td>
                <td>{item.daya}</td>
                <td>{item.npwp}</td>
                <td>{item.tarif}</td>
                <td>{item.totTetapDimukaPtl}</td>
                <td>{item.totTetapDimukaPpn}</td>
                <td>{item.resTokenawalPtl}</td>
                <td>{item.resTokenawalPpn}</td>
                <td>{item.resPestaPtl}</td>
                <td>{item.resPestaPpn}</td>
                <td>{item.resP2tlPtl}</td>
                <td>{item.resP2tlPpn}</td>
                <td>{item.resTskwhPtl}</td>
                <td>{item.resTskwhPpn}</td>
                <td>{item.resPrbyrPtl}</td>
                <td>{item.resPrbyrPpn}</td>
                <td>{item.totResPtl}</td>
                <td>{item.totResPpn}</td>
                <td>{item.totalR3Ptl}</td>
                <td>{item.totalR3Ppn}</td>
            </tr>
            {/for}

            <tr>
                <td colspan="5">TOTAL</td>
                <td>{sum_TOT_TETAP_DIMUKA_PTL}</td>
                <td>{sum_TOT_TETAP_DIMUKA_PPN}</td>
                <td>{sum_RES_TOKEN_AWAL_PTL}</td>
                <td>{sum_RES_TOKEN_AWAL_PPN}</td>
                <td>{sum_RES_PESTA_PTL}</td>
                <td>{sum_RES_PESTA_PPN}</td>
                <td>{sum_RES_P2TL_PTL}</td>
                <td>{sum_RES_P2TL_PPN}</td>
                <td>{sum_RES_TSKWH_PTL}</td>
                <td>{sum_RES_TSKWH_PPN}</td>
                <td>{sum_RES_PRBYR_PTL}</td>
                <td>{sum_RES_PRBYR_PPN}</td>
                <td>{sum_TOT_RES_PTL}</td>
                <td>{sum_TOT_RES_PPN}</td>
                <td>{sum_TOTAL_R3_PTL}</td>
                <td>{sum_TOTAL_R3_PPN}</td>
            </tr>
        </tbody>
    </table>

    <div class="keterangan">
        <table class="tbl-keterangan">
            <tr>
                <!-- Kolom kiri -->
                <td class="kolom-kiri" valign="top">
                    <p>Keterangan Lampiran 2 :</p>
                    <div style="padding-left: 50px;">
                        <p>Restitusi - Non Taglis :</p>
                        <p>Token Awal : pengembalian karena restitusi BP permohonan pb/pd</p>
                        <p>Pesta : pengembalian karena restitusi BP permohonan pesta</p>
                        <p>P2TL : pengembalian karena restitusi penetapan P2TL</p>
                        <p>TS-kWh : pengembalian karena restitusi penetapan TS-kWh</p>
                    </div>
                    <p>Restitusi - Prabayar : pengembalian pembelian token prepaid</p>
                </td>

                <!-- Kolom kanan -->
                <td class="kolom-kanan" valign="top">
                    <p>Total Restitusi :</p>
                    <div style="padding-left: 40px;">
                        <p>18 = 8 + 10 + 12 + 14 + 16</p>
                        <p>19 = 9 + 11 + 13 + 15 + 17</p>
                    </div>
                    <br>
                    <p>Total PPN R3 :</p>
                    <div style="padding-left: 40px;">
                        <p>20 = 6 - 18</p>
                        <p>21 = 7 - 19</p>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</body>

</html>