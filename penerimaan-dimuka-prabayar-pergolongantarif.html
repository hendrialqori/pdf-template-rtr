<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rekap Laporan Penerimaan Dimuka LPB</title>
  <style>
    @page :first {
      size: A3 landscape;
      /* orientasi kertas mendatar */
      margin: 1cm 1cm 2cm 1cm;
      /* margin kecil agar muat banyak kolom */
    }

    @page {
      size: A3 landscape;
      /* orientasi kertas mendatar */
      margin: 2cm 1cm 2cm 1cm;
      /* margin kecil agar muat banyak kolom */
    }

    /* RESET DASAR */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 12px;
    }

    body {
      padding: 20px;
    }

    /* HEADER TANPA BORDER */
    .header {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 10px;
    }

    .header img {
      width: 45px;
      height: auto;
    }

    .header-info {
      line-height: 1.3;
      font-size: 11px;
    }

    /* TITLE */
    .header-title {
      text-align: center;
      margin: 10px 0;
    }

    .header-title p {
      font-size: 13px;
      font-weight: bold;
      line-height: 1.4;
    }

    /* TABEL (DENGAN BORDER) */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      -fs-table-paginate: paginate;
    }

    th,
    td {
      border: 1px solid #000;
      padding: 4px 6px;
      text-align: center;
      font-size: 11px;
    }

    thead th {
      font-weight: bold;
      background-color: #f2f2f2;
    }

    tfoot td {
      font-size: 10px;
    }

    tr:nth-child(even) td {
      background-color: #f9f9f9;
    }

    @media print {
      table {
        page-break-inside: avoid;
      }

      thead {
        display: table-header-group !important;
      }

      tfoot {
        display: table-row-group;
      }
    }
  </style>
</head>

<body>
  <!-- HEADER TANPA BORDER -->
  <div class="header">
    <img src="data:image/png;base64,{logoBase64}" alt="Logo" />
    <div class="header-info">
      <div>PT PLN (PERSERO)</div>
      <div>{namaUpi ?: "SEMUA"}</div>
      <div>{namaAp ?: "SEMUA"}</div>
      <div>{namaUp ?: "SEMUA"}</div>
    </div>
  </div>

  <!-- TITLE -->
  <div class="header-title">
    <p>PENERIMAAN DI MUKA LISTRIK PRABAYAR</p>
    <p>PER GOLONGAN {jenisLaporan ?: ""}</p>
    <p>PERIODE {bulantahun ?: '-'}</p>
  </div>

  <!-- TABEL DENGAN BORDER -->
  <main>
    <table>
      <thead>
        <tr>
          <th rowspan="2">GOLONGAN {jenisLaporan ?: ""}</th>
          <th rowspan="2" colspan="2">
            SALDO AWAL<br />PEMAKAIAN DIMUKA LPB
          </th>
          <th colspan="14">MUTASI PENAMBAHAN</th>
          <th colspan="8">MUTASI PENGURANGAN</th>
          <th rowspan="2" colspan="2">
            SALDO AKHIR<br />PENERIMAAN DIMUKA LPB
          </th>
        </tr>
        <tr>
          <th colspan="2">PENJUALAN TOKEN</th>
          <th colspan="2">TOKEN PERDANA TUL 106</th>
          <th colspan="2">FREE TOKEN KOMP TMP</th>
          <th colspan="2">PESTA</th>
          <th colspan="2">FREE ISU UJL (NON TUNAI)</th>
          <th colspan="2">TOKEN PENGEMBALIAN</th>
          <th colspan="2">TOT MUTASI PENAMBAHAN</th>
          <th colspan="2">PENJUALAN LPB/PENDPTN</th>
          <th colspan="2">RESTITUSI TOKEN</th>
          <th colspan="2">TOKEN SISA YANG DIKONVERSI KE PRR</th>
          <th colspan="2">TOT MUTASI PENGURANG</th>
        </tr>
        <tr>
          <th></th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          <th>Rp</th>
          <th>Kwh</th>
          
        </tr>
        <tr>
          <th>1</th>
          <th>2</th>
          <th>3</th>
          <th>4</th>
          <th>5</th>
          <th>6</th>
          <th>7</th>
          <th>8</th>
          <th>9</th>
          <th>10</th>
          <th>11</th>
          <th>12</th>
          <th>13</th>
          <th>14</th>
          <th>15</th>
          <th>16</th>
          <th>17</th>
          <th>18</th>
          <th>19</th>
          <th>20</th>
          <th>21</th>
          <th>22</th>
          <th>23</th>
          <th>24=18 s.d 22</th>
          <th>25=19 s.d 23</th>
          <th>26=2+16-24</th>
          <th>27=3+17-25</th>
        </tr>
      </thead>

      <tfoot>
        {#for item in dataList}
        <tr>
          <td>{item.labelData}</td>

          <td>{item.rpPtlSaldo}</td>
          <td>{item.pemKwhSaldo}</td>

          <td>{item.rpPtlJualToken}</td>
          <td>{item.pemKwhJualToken}</td>

          <td>{item.rpPtl_106}</td>
          <td>{item.pemKwh_106}</td>

          <td>{item.rpPtlTmp}</td>
          <td>{item.pemKwhTmp}</td>

          <td>{item.rpPtlPesta}</td>
          <td>{item.pemKwhPesta}</td>

          <td>{item.rpPtlFreeIssue}</td>
          <td>{item.pemKwhFreeIssue}</td>

          <td>{item.rpPtlLebihBayar}</td>
          <td>{item.pemKwhLebihBayar}</td>

          <td>{item.rpPtlTotalTambahMut}</td>
          <td>{item.pemKwhTotalTambahMut}</td>

          <td>{item.rpPtlPenjualan}</td>
          <td>{item.pemKwhPenjualan}</td>

          <td>{item.rpPtlResitutsi}</td>
          <td>{item.pemKwhResitutsi}</td>

          <td>{item.rpPtlTokenSisa}</td>
          <td>{item.pemKwhTokenSisa}</td>

          <td>{item.rpPtlTotalKurangMut}</td>
          <td>{item.pemKwhTotalKurangMut}</td>

          <td>{item.rpPtlSaldoAkhir}</td>
          <td>{item.pemKwhSaldoAkhir}</td>
        </tr>
        {/for}
      </tfoot>
    </table>
  </main>
</body>

</html>