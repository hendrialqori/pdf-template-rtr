<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pemantauan Transaksi Rekap Koreksi Rekening Per Tanggal Transaksi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4 landscape;
            margin-top: 140px;
            margin-bottom: 80px;
            margin-left: 5mm;
            margin-right: 5mm;

            @top-left {
                content: element(pageHeader);
                width: 100%;
            }
            @bottom-left {
                content: element(pageFooter);
                width: 100%;
            }
        }
        #pageHeader {
            position: running(pageHeader);
            width: 100%;
        }
        #pageFooter {
            position: running(pageFooter);
            width: 100%;
        }

        .page-number:after {
            content: counter(page);
        }

        body {
            font-family: "Times New Roman", serif;
            font-size: 10px;
            margin: 10px;
            color: #000;
        }

        .table-header {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }

        .header-left {
            width: 30%;
            vertical-align: top;
            text-align: left;
        }

        .header-left table {
            border-collapse: collapse;
        }

        .header-left td {
            vertical-align: top;
            padding: 0;
            padding-right: 5px;
        }

        .header-left img {
            width: 55px;
            height: 55px;
            display: block;
        }

        .header-left p {
            line-height: 1.2;
            margin: 0;
            font-size: 10px;
        }

        .header-center {
            width: 40%;
            text-align: center;
            vertical-align: top;
        }

        .header-center p {
            margin: 2px 0;
            line-height: 1.3;
        }

        .bold {
            font-weight: bold;
        }

        .header-right {
            width: 30%;
        }

        .subheader {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .subheader td {
            padding: 2px 0;
        }

        .table-data {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            margin-bottom: 10px;
            table-layout: fixed;
        }

        .table-data th,
        .table-data td {
            padding: 3px 5px;
            border: none;
            font-size: 9px;
        }

        .table-data thead tr {
            border-top: 1px dotted #000;
            border-bottom: 1px dotted #000;
        }

        .table-data tbody tr:last-child {
            border-bottom: 1px dotted #000;
        }

        .jumlah-section {
            margin-top: 10px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .jumlah-title {
            font-weight: bold;
            font-size: 10px;
            white-space: nowrap;
        }

        .jumlah-status-title {
            font-weight: bold;
            font-size: 10px;
            white-space: nowrap;
            padding-left: 50px;
        }

        .jumlah-divider {
            width: 100%;
            border-top: 1px dotted #000;
            margin-top: 8px;
        }

        .rincian {
            margin-top: 6px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px dotted #000;
        }

        .rincian table {
            border-collapse: collapse;
            width: 40%;
        }

        .rincian td {
            padding: 1px 0;
            vertical-align: middle;
            font-size: 9px;
        }

        .rincian .label {
            text-align: left;
            white-space: nowrap;
        }

        .rincian .value {
            text-align: right;
            width: 80px;
            padding-right: 40px;
        }

        .rincian .col1 {
            width: 15%;
        }

        .rincian .col2 {
            width: 18%;
        }

        .rincian .col3 {
            width: 8%;
        }

        .rincian .col4 {
            width: 18%;
        }

        .rincian .col5 {
            width: 8%;
        }

        .rincian .col6 {
            width: 18%;
        }

        .rincian .col7 {
            width: 8%;
        }

        .footer-print {
            width: 100%;
            border-collapse: collapse;
            border-top: 1px dotted #000;
            border-bottom: 1px dotted #000;
            margin-top: 10px;
            font-size: 9px;
        }

        .footer-print td {
            padding: 4px 0;
        }

        /* ATURAN KHUSUS CETAK (PRINT) */
        @media print {
            .table-data {
                page-break-inside: auto;
            }

            .table-data tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }

            .table-data thead {
                display: table-header-group;
            }

            .footer-print {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>
<!-- HEADER -->
<div id="pageHeader">
<table class="table-header">
    <tr>
        <td class="header-left">
            <table>
                <tr>
                    <td>
                        <img src="data:image/png;base64,{logoBase64}" alt="Logo PLN" width="64" height="70" />
                    </td>
                    <td>
                        <p><strong>PT PLN (PERSERO) UIW : {upi ?: ''}</strong></p>
                        <p>UP3 : {ap ?: ''}</p>
                        <p>ULP : {up ?: ''}</p>
                        <p>{alamatKantor ?: ''}</p>
                    </td>
                </tr>
            </table>
        </td>
        <td class="header-center">
            <p>PEMANTAUAN TRANSAKSI DATA PIUTANG PELANGGAN - DPP</p>
            <p class="bold">KDPEMBPP = R1 - REKENING LISTRIK</p>
            <p>TANGGAL : {tglMulai ?: ''} s/d {tglSelesai ?: ''}</p>
            <p class="bold">Pemantauan Transaksi berdasarkan Tanggal Pelaksanaan Transaksi</p>
        </td>
        <td class="header-right"></td>
    </tr>
</table>
</div>

<!-- FOOTER -->
<div id="pageFooter">
<table class="footer-print">
    <tr>
        <td style="width: 25%; text-align: left;">Petugas Cetak : {petugasCetak ?: ''}</td>
        <td style="width: 25%; text-align: center;">KdGerak : 12</td>
        <td style="width: 25%; text-align: center;">Tgl Cetak : {tglCetak ?: ''}</td>
        <td style="width: 25%; text-align: right;">Halaman <span class="page-number"></span></td>
    </tr>
</table>
</div>

<!-- DATA TABLE -->
<table class="table-data">
    <thead>
    <tr>
        <th>TglTransaksi</th>
        <th>TglBuku</th>
        <th>Sts</th>
        <th>Gol</th>
        <th>Krs</th>
        <th>Data</th>
        <th>Lembar</th>
        <th>RpPTL</th>
        <th>RpBPJU</th>
        <th>RpPPN</th>
        <th>RpMaterai</th>
        <th>RpLain2</th>
        <th>RpTagihan</th>
        <th>RpBK</th>
    </tr>
    </thead>
    <tbody>
    {#for item in dataList}
    <tr>
    <td>{item.tanggal ?: ''}</td>
    <td>{item.tglbuku ?: ''}</td>
    <td>{item.status ?: ''}</td>
    <td>{item.kogol ?: ''}</td>
    <td>{item.kdkoreksi ?: ''}</td>
    <td>{item.datarekg ?: ''}</td>
    <td>{item.lembar ?: ''}</td>
    <td>{item.rpptl ?: ''}</td>
    <td>{item.rpbpju ?: ''}</td>
    <td>{item.rpppn ?: ''}</td>
    <td>{item.rpmat ?: ''}</td>
    <td>{item.rplain2 ?: ''}</td>
    <td>{item.rptag ?: ''}</td>
    <td>{item.rpbk ?: ''}</td>
    </tr>
    {/for}
    </tbody>
</table>

<!-- JUMLAH STATUS ROW -->
<table class="table-data">
    <tbody>
    <tr style="font-weight: bold; border-bottom: 1px dotted #000;">
        <td colspan="6" style="text-align: left; padding-left: 80px; font-size: 11px;">JUMLAH STATUS : L</td>
        <td>{lembarSummary}</td>
        <td>{rpptlSummary}</td>
        <td>{rpbpjuSummary}</td>
        <td>{rpppnSummary}</td>
        <td>{rpmatSummary}</td>
        <td>{rplain2Summary}</td>
        <td>{rptagSummary}</td>
        <td>{rpbkSummary}</td>
    </tr>
    </tbody>
</table>

<!-- JUMLAH ROW -->
<table class="table-data">
    <tbody>
    <tr style="font-weight: bold; border-bottom: 1px dotted #000;">
        <td colspan="6" style="text-align: left; padding-left: 40px; font-size: 11px;">JUMLAH</td>
        <td>{lembarSummary}</td>
        <td>{rpptlSummary}</td>
        <td>{rpbpjuSummary}</td>
        <td>{rpppnSummary}</td>
        <td>{rpmatSummary}</td>
        <td>{rplain2Summary}</td>
        <td>{rptagSummary}</td>
        <td>{rpbkSummary}</td>
    </tr>
    </tbody>
</table>

<div class="rincian">
    <table>
        <tr>
            <td class="label col1">Rincian RPLAIN2 :</td>
            <td class="label col2">RpTrafo :</td>
            <td class="value col3">{rptrafoSummary}</td>
            <td class="label col4">Jml.Angsuran :</td>
            <td class="value col5">{rpangsSummary}</td>
            <td class="label col6">RpPotongan :</td>
            <td class="value col7">{rpreduksiSummary}</td>
        </tr>
        <tr>
            <td class="col1"></td>
            <td class="label col2">RpSewaTrafo :</td>
            <td class="value col3">{rpsewatrafoSummary}</td>
            <td class="col4"></td>
            <td class="col5"></td>
            <td class="label col6">RpTambahBiaya :</td>
            <td class="value col7">{rptbSummary}</td>
        </tr>
        <tr>
            <td class="col1"></td>
            <td class="label col2">RpSewaKapasitor :</td>
            <td class="value col3">{rpsewakapSummary}</td>
            <td class="col4"></td>
            <td class="col5"></td>
            <td class="col6"></td>
            <td class="col7"></td>
        </tr>
    </table>
</div>

</body>

</html>